(()=>{"use strict";var e={857:e=>{var t=function(e){var t;return!!e&&"object"==typeof e&&"[object RegExp]"!==(t=Object.prototype.toString.call(e))&&"[object Date]"!==t&&e.$$typeof!==n},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?o(Array.isArray(e)?[]:{},e,t):e}function r(e,t,n){return e.concat(t).map(function(e){return i(e,n)})}function l(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function s(e,t){try{return t in e}catch(e){return!1}}function o(e,n,a){(a=a||{}).arrayMerge=a.arrayMerge||r,a.isMergeableObject=a.isMergeableObject||t,a.cloneUnlessOtherwiseSpecified=i;var d,u,c=Array.isArray(n);return c!==Array.isArray(e)?i(n,a):c?a.arrayMerge(e,n,a):(u={},(d=a).isMergeableObject(e)&&l(e).forEach(function(t){u[t]=i(e[t],d)}),l(n).forEach(function(t){(!s(e,t)||Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))&&(s(e,t)&&d.isMergeableObject(n[t])?u[t]=(function(e,t){if(!t.customMerge)return o;var n=t.customMerge(e);return"function"==typeof n?n:o})(t,d)(e[t],n[t],d):u[t]=i(n[t],d))}),u)}o.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,n){return o(e,n,t)},{})},e.exports=o}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var l=t[i]={exports:{}};return e[i](l,l.exports,n),l.exports}(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{class e{get(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/json",i=this._createPreparedRequest("GET",e,n);return this._sendRequest(i,null,t)}post(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";i=this._getContentType(t,i);let r=this._createPreparedRequest("POST",e,i);return this._sendRequest(r,t,n)}delete(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";i=this._getContentType(t,i);let r=this._createPreparedRequest("DELETE",e,i);return this._sendRequest(r,t,n)}patch(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";i=this._getContentType(t,i);let r=this._createPreparedRequest("PATCH",e,i);return this._sendRequest(r,t,n)}abort(){if(this._request)return this._request.abort()}setErrorHandlingInternal(e){this._errorHandlingInternal=e}_registerOnLoaded(e,t){t&&(!0===this._errorHandlingInternal?(e.addEventListener("load",()=>{t(e.responseText,e)}),e.addEventListener("abort",()=>{console.warn("the request to ".concat(e.responseURL," was aborted"))}),e.addEventListener("error",()=>{console.warn("the request to ".concat(e.responseURL," failed with status ").concat(e.status))}),e.addEventListener("timeout",()=>{console.warn("the request to ".concat(e.responseURL," timed out"))})):e.addEventListener("loadend",()=>{t(e.responseText,e)}))}_sendRequest(e,t,n){return this._registerOnLoaded(e,n),e.send(t),e}_getContentType(e,t){return e instanceof FormData&&(t=!1),t}_createPreparedRequest(e,t,n){return this._request=new XMLHttpRequest,this._request.open(e,t),this._request.setRequestHeader("X-Requested-With","XMLHttpRequest"),n&&this._request.setRequestHeader("Content-type",n),this._request}constructor(){this._request=null,this._errorHandlingInternal=!1}}var t,i,r,l,s,o,a,d,u,c,m,h,b,g,p,_,y,f=n(857),E=n.n(f);class v{static ucFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}static lcFirst(e){return e.charAt(0).toLowerCase()+e.slice(1)}static toDashCase(e){return e.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(e,t){let n=v.toUpperCamelCase(e,t);return v.lcFirst(n)}static toUpperCamelCase(e,t){return t?e.split(t).map(e=>v.ucFirst(e.toLowerCase())).join(""):v.ucFirst(e.toLowerCase())}static parsePrimitive(e){try{return/^\d+(.|,)\d+$/.test(e)&&(e=e.replace(",",".")),JSON.parse(e)}catch(t){return e.toString()}}}class I{static isNode(e){return"object"==typeof e&&null!==e&&(e===document||e===window||e instanceof Node)}static hasAttribute(e,t){if(!I.isNode(e))throw Error("The element must be a valid HTML Node!");return"function"==typeof e.hasAttribute&&e.hasAttribute(t)}static getAttribute(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(n&&!1===I.hasAttribute(e,t))throw Error('The required property "'.concat(t,'" does not exist!'));if("function"!=typeof e.getAttribute){if(n)throw Error("This node doesn't support the getAttribute function!");return}return e.getAttribute(t)}static getDataAttribute(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.replace(/^data(|-)/,""),r=v.toLowerCamelCase(i,"-");if(!I.isNode(e)){if(n)throw Error("The passed node is not a valid HTML Node!");return}if(void 0===e.dataset){if(n)throw Error("This node doesn't support the dataset attribute!");return}let l=e.dataset[r];if(void 0===l){if(n)throw Error('The required data attribute "'.concat(t,'" does not exist on ').concat(e,"!"));return l}return v.parsePrimitive(l)}static querySelector(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(n&&!I.isNode(e))throw Error("The parent node is not a valid HTML Node!");let i=e.querySelector(t)||!1;if(n&&!1===i)throw Error('The required element "'.concat(t,'" does not exist in parent node!'));return i}static querySelectorAll(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(n&&!I.isNode(e))throw Error("The parent node is not a valid HTML Node!");let i=e.querySelectorAll(t);if(0===i.length&&(i=!1),n&&!1===i)throw Error('At least one item of "'.concat(t,'" must exist in parent node!'));return i}static getFocusableElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return e.querySelectorAll('\n            input:not([tabindex^="-"]):not([disabled]):not([type="hidden"]),\n            select:not([tabindex^="-"]):not([disabled]),\n            textarea:not([tabindex^="-"]):not([disabled]),\n            button:not([tabindex^="-"]):not([disabled]),\n            a[href]:not([tabindex^="-"]):not([disabled]),\n            [tabindex]:not([tabindex^="-"]):not([disabled])\n        ')}static getFirstFocusableElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return this.getFocusableElements(e)[0]}static getLastFocusableElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=this.getFocusableElements(e);return t[t.length-1]}}class w{publish(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new CustomEvent(e,{detail:t,cancelable:n});return this.el.dispatchEvent(i),i}subscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this,r=e.split("."),l=n.scope?t.bind(n.scope):t;if(n.once&&!0===n.once){let t=l;l=function(n){i.unsubscribe(e),t(n)}}return this.el.addEventListener(r[0],l),this.listeners.push({splitEventName:r,opts:n,cb:l}),!0}unsubscribe(e){let t=e.split(".");return this.listeners=this.listeners.reduce((e,n)=>([...n.splitEventName].sort().toString()===t.sort().toString()?this.el.removeEventListener(n.splitEventName[0],n.cb):e.push(n),e),[]),!0}reset(){return this.listeners.forEach(e=>{this.el.removeEventListener(e.splitEventName[0],e.cb)}),this.listeners=[],!0}get el(){return this._el}set el(e){this._el=e}get listeners(){return this._listeners}set listeners(e){this._listeners=e}constructor(e=document){this._el=e,e.$emitter=this,this._listeners=[]}}class B{init(){throw Error('The "init" method for the plugin "'.concat(this._pluginName,'" is not defined.'))}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(e){let t=v.toDashCase(this._pluginName),n=I.getDataAttribute(this.el,"data-".concat(t,"-config"),!1),i=I.getAttribute(this.el,"data-".concat(t,"-options"),!1),r=[this.constructor.options,this.options,e];n&&r.push(window.PluginConfigManager.get(this._pluginName,n));try{i&&r.push(JSON.parse(i))}catch(e){throw console.error(this.el),Error('The data attribute "data-'.concat(t,'-options" could not be parsed to json: ').concat(e.message))}return E().all(r.filter(e=>e instanceof Object&&!(e instanceof Array)).map(e=>e||{}))}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this),window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(e){return e||(e=this.constructor.name),e}constructor(e,t={},n=!1){if(!I.isNode(e))throw Error("There is no valid element given.");this.el=e,this.$emitter=new w(this.el),this._pluginName=this._getPluginName(n),this.options=this._mergeOptions(t),this._initialized=!1,this._registerInstance(),this._init()}}window.PluginManager.register("BfnDebitPlugin",class extends B{init(){if(this._client=new e,t=null!==document.getElementById("bfn_direct_debit_owner_input")?document.getElementById("bfn_direct_debit_owner_input").value:null,i=null!==document.getElementById("bfn_direct_debit_iban_input")?document.getElementById("bfn_direct_debit_iban_input").value:null,r=null!==document.getElementById("bfn_direct_debit_bic_input")?document.getElementById("bfn_direct_debit_bic_input").value:null,l=null!==document.getElementById("af-base-url")?document.getElementById("af-base-url").value:null,o=document.getElementById("bfn_direct_debit_iban_input"),s=document.getElementById("bfn_direct_debit_bic_input"),a=document.getElementById("iban-error"),d=document.getElementById("swift-error"),null!==document.getElementById("validate-active-route")&&document.getElementById("validate-active-route").value,h=null!==document.getElementById("editDirectDebitOwner")?document.getElementById("editDirectDebitOwner"):null,b=null!==document.getElementById("editDirectDebitIban")?document.getElementById("editDirectDebitIban"):null,g=null!==document.getElementById("editDirectDebitBicSwift")?document.getElementById("editDirectDebitBicSwift"):null,p=null!==document.getElementById("editDirectDebitMandate")?document.getElementById("editDirectDebitMandate"):null,_=null!==document.getElementById("last-four")?document.getElementById("last-four").value:null,y=null!==document.getElementById("original-length")?document.getElementById("original-length").value:null,!this.isDirectDebitSelected())return;null!==a&&(a.style.display="none"),null!==d&&(d.style.display="none"),null!==o?o.hasAttribute("data-keyup-attached")||(o.addEventListener("input",()=>{i=document.getElementById("bfn_direct_debit_iban_input").value,this._ibanValidation()}),o.setAttribute("data-keyup-attached","true")):u=!0,null!==s?s.hasAttribute("data-keyup-attached")||(s.addEventListener("input",()=>{r=document.getElementById("bfn_direct_debit_bic_input").value,this._swiftCodeValidation()}),s.setAttribute("data-keyup-attached","true")):c=!0,null!==document.getElementById("confirmFormSubmit")&&(document.getElementById("confirmFormSubmit").disabled=!0);let n=document.getElementById("mandateCheck");n?(n.addEventListener("change",()=>{this._checkboxValidation()}),m=!1):m=!0;let f=document.getElementById("confirmOrderForm");f&&f.addEventListener("submit",e=>{this._handleFormSubmit()});let E=document.getElementById("plugin-config");E&&(this.maskIban=E.getAttribute("data-mask-iban"),this.maskIban&&this._addPasswordToggle()),this._registerEvents()}_addPasswordToggle(){let e=document.querySelector("input#bfn_direct_debit_iban_input[type=password]");if(e&&!e.parentElement.querySelector(".passwordMask")){let t=document.createElement("div");t.classList.add("passwordMask"),t.addEventListener("click",()=>{t.classList.toggle("isVisible"),"text"==e.getAttribute("type")?e.setAttribute("type","password"):e.setAttribute("type","text")}),e.parentElement.insertBefore(t,e)}}_handleFormSubmit(){t=null!==document.getElementById("bfn_direct_debit_owner_input")?document.getElementById("bfn_direct_debit_owner_input").value:null,i=null!==document.getElementById("bfn_direct_debit_iban_input")?document.getElementById("bfn_direct_debit_iban_input").value:null,r=null!==document.getElementById("bfn_direct_debit_bic_input")?document.getElementById("bfn_direct_debit_bic_input").value:null,null!==h&&(h.value=t),null!==b&&(b.value=i),null!==g&&(g.value=r);let e=document.getElementById("mandateCheck");null!==p&&null!==e&&e.checked&&(p.value=1)}isDirectDebitSelected(){let e=null!==document.getElementById("directDebitPaymentMethodId")?document.getElementById("directDebitPaymentMethodId").value:null;if(null===e)return!1;let t=document.querySelectorAll('input[name="paymentMethodId"]');for(let n=0;n<t.length;n++)if(t[n].checked&&t[n].value===e)return!0;return!1}_registerEvents(){this._ibanValidation(),null!==r&&this._swiftCodeValidation(),document.getElementById("mandateCheck")&&this._checkboxValidation()}_ibanValidation(){if(i.match(/^X{10}/)&&i.slice(-4)===_&&i.length==y&&null!==i&&""!==i.trim()&&i.trim().length>=15)a.style.display="none",u=!0,this._changeButtonAppearance();else if(null!==i&&""!==i.trim()&&i.trim().length>=15){let e=JSON.stringify({getIbanNumber:i});this._client.post(l+"directDebit/validateIban/iban",e,this._setContent.bind(this),"application/json",!0),this._changeButtonAppearance()}else i.trim().length>=1&&i.trim().length<=15&&(u=!1,a.style.display="block"),this._changeButtonAppearance()}_setContent(e){null!==a&&("true"==e?(a.style.display="none",u=!0):(a.style.display="block",u=!1),this._changeButtonAppearance())}_swiftCodeValidation(){if(null!==r&&""!==r.trim()&&r.trim().length>=8){let e=JSON.stringify({getSwiftNumber:r});this._client.post(l+"directDebit/validateSwift/swiftCode",e,this._setSwiftContent.bind(this),"application/json",!0)}else r.trim().length>=1&&r.trim().length<=8&&(c=!1,d.style.display="block"),this._changeButtonAppearance()}_setSwiftContent(e){null!==d&&("true"==e?(d.style.display="none",c=!0):(d.style.display="block",c=!1),this._changeButtonAppearance())}_checkboxValidation(){let e=document.getElementById("mandateCheck");e&&(m=!!e.checked,this._changeButtonAppearance())}_changeButtonAppearance(){!0===u&&!0===c&&!0===m?null!==document.getElementById("confirmFormSubmit")&&(document.getElementById("confirmFormSubmit").disabled=!1,null!==document.getElementById("directDebitInfoMessage")&&(document.getElementById("directDebitInfoMessage").style.display="none")):(null!==document.getElementById("confirmFormSubmit")&&(document.getElementById("confirmFormSubmit").disabled=!0),null!==document.getElementById("directDebitInfoMessage")&&(document.getElementById("directDebitInfoMessage").style.display="block"))}},"[restrict-order-filter]")})()})();